    - name: Custom Configuration (Force IPQ6000)
      run: |
        cd openwrt
        # 清除可能存在的旧配置
        rm -f .config
        
        # 核心：必须先写入这三行，强制指定硬件平台
        echo "CONFIG_TARGET_ipq60xx=y" > .config
        echo "CONFIG_TARGET_ipq60xx_generic=y" >> .config
        echo "CONFIG_TARGET_ipq60xx_generic_DEVICE_jdcloud_re-ss-01=y" >> .config
        
        # 写入你需要的 5.15 内核与 NSS 插件
        cat >> .config <<EOF
        CONFIG_LINUX_5_15=y
        CONFIG_PACKAGE_kmod-qca-nss-drv=y
        CONFIG_PACKAGE_kmod-qca-nss-ecm=y
        CONFIG_PACKAGE_kmod-qca-nss-ecm-standard=y
        CONFIG_PACKAGE_kmod-qca-nss-drv-pppoe=y
        CONFIG_PACKAGE_kmod-qca-nss-drv-ipv6=y
        CONFIG_PACKAGE_luci-app-smartdns=y
        CONFIG_PACKAGE_luci-app-sqm=y
        CONFIG_PACKAGE_kmod-sched-cake=y
        CONFIG_PACKAGE_luci-app-turboacc=y
        CONFIG_PACKAGE_luci-app-pbr=y
        CONFIG_PACKAGE_ipv6helper=y
        EOF
        
        # 关键步骤：扩展配置并检查是否真的切换到了 IPQ6000
        make defconfig
        grep "CONFIG_TARGET_ipq60xx=y" .config || (echo "Target Error!" && exit 1)
